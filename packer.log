2022/01/18 14:07:39 [INFO] Packer version: 1.7.8 [go1.17.2 linux amd64]
2022/01/18 14:07:39 [TRACE] discovering plugins in /usr/bin
2022/01/18 14:07:39 [TRACE] discovering plugins in /root/.config/packer/plugins
2022/01/18 14:07:39 [TRACE] discovering plugins in .
2022/01/18 14:07:39 [INFO] PACKER_CONFIG env var not set; checking the default config file path
2022/01/18 14:07:39 [INFO] PACKER_CONFIG env var set; attempting to open config file: /root/.packerconfig
2022/01/18 14:07:39 [WARN] Config file doesn't exist: /root/.packerconfig
2022/01/18 14:07:39 [INFO] Setting cache directory: /root/.cache/packer
2022/01/18 14:07:39 [TRACE] Starting internal plugin packer-builder-qemu
2022/01/18 14:07:39 Starting plugin: /usr/bin/packer []string{"/usr/bin/packer", "plugin", "packer-builder-qemu"}
2022/01/18 14:07:39 Waiting for RPC address for: /usr/bin/packer
2022/01/18 14:07:39 Received unix RPC address for /usr/bin/packer: addr is /tmp/packer-plugin1583691099
2022/01/18 14:07:39 packer-builder-qemu plugin: [INFO] Packer version: 1.7.8 [go1.17.2 linux amd64]
2022/01/18 14:07:39 packer-builder-qemu plugin: [INFO] PACKER_CONFIG env var not set; checking the default config file path
2022/01/18 14:07:39 packer-builder-qemu plugin: [INFO] PACKER_CONFIG env var set; attempting to open config file: /root/.packerconfig
2022/01/18 14:07:39 packer-builder-qemu plugin: [WARN] Config file doesn't exist: /root/.packerconfig
2022/01/18 14:07:39 packer-builder-qemu plugin: [INFO] Setting cache directory: /root/.cache/packer
2022/01/18 14:07:39 packer-builder-qemu plugin: args: []string{"packer-builder-qemu"}
2022/01/18 14:07:39 packer-builder-qemu plugin: Plugin address: unix /tmp/packer-plugin1583691099
2022/01/18 14:07:39 packer-builder-qemu plugin: Waiting for connection...
2022/01/18 14:07:39 packer-builder-qemu plugin: Serving a plugin connection...
2022/01/18 14:07:39 packer-builder-qemu plugin: use specified accelerator: kvm
2022/01/18 14:07:39 packer-builder-qemu plugin: CpuCount 0 too small, using default: 1
2022/01/18 14:07:39 [TRACE] Starting internal plugin packer-provisioner-ansible
2022/01/18 14:07:39 Starting plugin: /usr/bin/packer []string{"/usr/bin/packer", "plugin", "packer-provisioner-ansible"}
2022/01/18 14:07:39 Waiting for RPC address for: /usr/bin/packer
2022/01/18 14:07:39 Received unix RPC address for /usr/bin/packer: addr is /tmp/packer-plugin944641635
2022/01/18 14:07:39 packer-provisioner-ansible plugin: [INFO] Packer version: 1.7.8 [go1.17.2 linux amd64]
2022/01/18 14:07:39 packer-provisioner-ansible plugin: [INFO] PACKER_CONFIG env var not set; checking the default config file path
2022/01/18 14:07:39 packer-provisioner-ansible plugin: [INFO] PACKER_CONFIG env var set; attempting to open config file: /root/.packerconfig
2022/01/18 14:07:39 packer-provisioner-ansible plugin: [WARN] Config file doesn't exist: /root/.packerconfig
2022/01/18 14:07:39 packer-provisioner-ansible plugin: [INFO] Setting cache directory: /root/.cache/packer
2022/01/18 14:07:39 packer-provisioner-ansible plugin: args: []string{"packer-provisioner-ansible"}
2022/01/18 14:07:39 packer-provisioner-ansible plugin: Plugin address: unix /tmp/packer-plugin944641635
2022/01/18 14:07:39 packer-provisioner-ansible plugin: Waiting for connection...
2022/01/18 14:07:39 packer-provisioner-ansible plugin: Serving a plugin connection...
2022/01/18 14:07:40 ui: [1;32mqemu.example: output will be in this color.[0m
2022/01/18 14:07:40 ui: 
2022/01/18 14:07:40 Build debug mode: false
2022/01/18 14:07:40 Force build: false
2022/01/18 14:07:40 On error: 
2022/01/18 14:07:40 Waiting on builds to complete...
2022/01/18 14:07:40 Starting build run: qemu.example
2022/01/18 14:07:40 Running builder: 
2022/01/18 14:07:40 [INFO] (telemetry) Starting builder qemu.example
2022/01/18 14:07:40 packer-provisioner-ansible plugin: ansible-playbook version: 2.9.27
2022/01/18 14:07:40 packer-builder-qemu plugin: Qemu path: /usr/libexec/qemu-kvm, Qemu Image path: /usr/bin/qemu-img
2022/01/18 14:07:40 ui: [1;32m==> qemu.example: Retrieving ISO[0m
2022/01/18 14:07:40 ui: [1;32m==> qemu.example: Trying /root/Rocky-8.4-x86_64-minimal.iso[0m
2022/01/18 14:07:40 packer-builder-qemu plugin: Acquiring lock for: /root/Rocky-8.4-x86_64-minimal.iso?checksum=sha256%3A0de5f12eba93e00fefc06cdb0aa4389a0972a4212977362ea18bde46a1a1aa4f (/root/.cache/packer/daa66980124d50ed0d5c39073ca1d52f04d357d0.iso.lock)
2022/01/18 14:07:40 ui: [1;32m==> qemu.example: Trying /root/Rocky-8.4-x86_64-minimal.iso?checksum=sha256%3A0de5f12eba93e00fefc06cdb0aa4389a0972a4212977362ea18bde46a1a1aa4f[0m
2022/01/18 14:07:52 ui: [1;32m==> qemu.example: /root/Rocky-8.4-x86_64-minimal.iso?checksum=sha256%3A0de5f12eba93e00fefc06cdb0aa4389a0972a4212977362ea18bde46a1a1aa4f => /root/Rocky-8.4-x86_64-minimal.iso[0m
2022/01/18 14:07:52 packer-builder-qemu plugin: Leaving retrieve loop for ISO
2022/01/18 14:07:52 packer-builder-qemu plugin: No floppy files specified. Floppy disk will not be made.
2022/01/18 14:07:52 packer-builder-qemu plugin: No CD files specified. CD disk will not be made.
2022/01/18 14:07:52 packer-builder-qemu plugin: [INFO] Creating disk with Path: build-rocky-8/tp-1 and Size: 5000M
2022/01/18 14:07:52 packer-builder-qemu plugin: Executing qemu-img: []string{"create", "-f", "qcow2", "build-rocky-8/tp-1", "5000M"}
2022/01/18 14:07:52 ui: [1;32m==> qemu.example: Starting HTTP server on port 8413[0m
2022/01/18 14:07:52 packer-builder-qemu plugin: stdout: Formatting 'build-rocky-8/tp-1', fmt=qcow2 size=5242880000 cluster_size=65536 lazy_refcounts=off refcount_bits=16
2022/01/18 14:07:52 packer-builder-qemu plugin: stderr:
2022/01/18 14:07:52 packer-builder-qemu plugin: Found available port: 8413 on IP: 0.0.0.0
2022/01/18 14:07:52 packer-builder-qemu plugin: Looking for available communicator (SSH, WinRM, etc) port between 2222 and 4444
2022/01/18 14:07:52 packer-builder-qemu plugin: Found available port: 3860 on IP: 127.0.0.1
2022/01/18 14:07:52 ui: [1;32m==> qemu.example: Found port for communicator (SSH, WinRM, etc): 3860.[0m
2022/01/18 14:07:52 ui: [1;32m==> qemu.example: Looking for available port between 5900 and 6000 on 127.0.0.1[0m
2022/01/18 14:07:52 packer-builder-qemu plugin: Looking for available port between 5900 and 6000 on 127.0.0.1
2022/01/18 14:07:52 packer-builder-qemu plugin: Found available port: 5960 on IP: 127.0.0.1
2022/01/18 14:07:52 packer-builder-qemu plugin: Found available VNC port: 5960 on IP: 127.0.0.1
2022/01/18 14:07:52 ui: [1;32m==> qemu.example: Starting VM, booting from CD-ROM[0m
2022/01/18 14:07:52 packer-builder-qemu plugin: Qemu --version output: QEMU emulator version 4.2.0 (qemu-kvm-4.2.0-59.module+el8.5.0+726+ce09ee88.1)
2022/01/18 14:07:52 packer-builder-qemu plugin: Copyright (c) 2003-2019 Fabrice Bellard and the QEMU Project developers
2022/01/18 14:07:52 packer-builder-qemu plugin: Qemu version: 4.2.0
2022/01/18 14:07:52 ui: [0;32m    qemu.example: The VM will be run headless, without a GUI. If you want to
    qemu.example: view the screen of the VM, connect via VNC without a password to
    qemu.example: vnc://127.0.0.1:5960[0m
2022/01/18 14:07:52 packer-builder-qemu plugin: Qemu Builder has no floppy files, not attaching a floppy.
2022/01/18 14:07:52 packer-builder-qemu plugin: Executing /usr/libexec/qemu-kvm: []string{"-device", "virtio-net,netdev=user.0", "-drive", "file=build-rocky-8/tp-1,if=virtio,cache=writeback,discard=ignore,format=qcow2", "-drive", "file=/root/Rocky-8.4-x86_64-minimal.iso,media=cdrom", "-boot", "once=d", "-name", "tp-1", "-machine", "type=pc,accel=kvm", "-netdev", "user,id=user.0,hostfwd=tcp::3860-:22", "-vnc", "127.0.0.1:60", "-m", "2048M"}
2022/01/18 14:07:52 packer-builder-qemu plugin: Started Qemu. Pid: 13479
2022/01/18 14:07:54 ui: [1;32m==> qemu.example: Waiting 10s for boot...[0m
2022/01/18 14:08:04 ui: [1;32m==> qemu.example: Connecting to VM via VNC (127.0.0.1:5960)[0m
2022/01/18 14:08:04 ui: [1;32m==> qemu.example: Typing the boot command over VNC...[0m
2022/01/18 14:08:04 packer-builder-qemu plugin: Connected to VNC desktop: QEMU (tp-1)
2022/01/18 14:08:04 packer-builder-qemu plugin: Special code '<tab>' found, replacing with: 0xFF09
2022/01/18 14:08:04 packer-builder-qemu plugin: Sending char ' ', code 0x20, shift false
2022/01/18 14:08:04 packer-builder-qemu plugin: Sending char 't', code 0x74, shift false
2022/01/18 14:08:05 packer-builder-qemu plugin: Sending char 'e', code 0x65, shift false
2022/01/18 14:08:05 packer-builder-qemu plugin: Sending char 'x', code 0x78, shift false
2022/01/18 14:08:05 packer-builder-qemu plugin: Sending char 't', code 0x74, shift false
2022/01/18 14:08:05 packer-builder-qemu plugin: Sending char ' ', code 0x20, shift false
2022/01/18 14:08:05 packer-builder-qemu plugin: Sending char 'i', code 0x69, shift false
2022/01/18 14:08:06 packer-builder-qemu plugin: Sending char 'n', code 0x6E, shift false
2022/01/18 14:08:06 packer-builder-qemu plugin: Sending char 's', code 0x73, shift false
2022/01/18 14:08:06 packer-builder-qemu plugin: Sending char 't', code 0x74, shift false
2022/01/18 14:08:06 packer-builder-qemu plugin: Sending char '.', code 0x2E, shift false
2022/01/18 14:08:06 packer-builder-qemu plugin: Sending char 'k', code 0x6B, shift false
2022/01/18 14:08:07 packer-builder-qemu plugin: Sending char 's', code 0x73, shift false
2022/01/18 14:08:07 packer-builder-qemu plugin: Sending char '=', code 0x3D, shift false
2022/01/18 14:08:07 packer-builder-qemu plugin: Sending char 'h', code 0x68, shift false
2022/01/18 14:08:07 packer-builder-qemu plugin: Sending char 't', code 0x74, shift false
2022/01/18 14:08:08 packer-builder-qemu plugin: Sending char 't', code 0x74, shift false
2022/01/18 14:08:08 packer-builder-qemu plugin: Sending char 'p', code 0x70, shift false
2022/01/18 14:08:08 packer-builder-qemu plugin: Sending char ':', code 0x3A, shift true
2022/01/18 14:08:08 packer-builder-qemu plugin: Sending char '/', code 0x2F, shift false
2022/01/18 14:08:09 packer-builder-qemu plugin: Sending char '/', code 0x2F, shift false
2022/01/18 14:08:09 packer-builder-qemu plugin: Sending char '1', code 0x31, shift false
2022/01/18 14:08:09 packer-builder-qemu plugin: Sending char '9', code 0x39, shift false
2022/01/18 14:08:09 packer-builder-qemu plugin: Sending char '2', code 0x32, shift false
2022/01/18 14:08:09 packer-builder-qemu plugin: Sending char '.', code 0x2E, shift false
2022/01/18 14:08:10 packer-builder-qemu plugin: Sending char '1', code 0x31, shift false
2022/01/18 14:08:10 packer-builder-qemu plugin: Sending char '6', code 0x36, shift false
2022/01/18 14:08:10 packer-builder-qemu plugin: Sending char '8', code 0x38, shift false
2022/01/18 14:08:10 packer-builder-qemu plugin: Sending char '.', code 0x2E, shift false
2022/01/18 14:08:10 packer-builder-qemu plugin: Sending char '1', code 0x31, shift false
2022/01/18 14:08:11 packer-builder-qemu plugin: Sending char '2', code 0x32, shift false
2022/01/18 14:08:11 packer-builder-qemu plugin: Sending char '2', code 0x32, shift false
2022/01/18 14:08:11 packer-builder-qemu plugin: Sending char '.', code 0x2E, shift false
2022/01/18 14:08:11 packer-builder-qemu plugin: Sending char '1', code 0x31, shift false
2022/01/18 14:08:11 packer-builder-qemu plugin: Sending char ':', code 0x3A, shift true
2022/01/18 14:08:12 packer-builder-qemu plugin: Sending char '8', code 0x38, shift false
2022/01/18 14:08:12 packer-builder-qemu plugin: Sending char '4', code 0x34, shift false
2022/01/18 14:08:12 packer-builder-qemu plugin: Sending char '1', code 0x31, shift false
2022/01/18 14:08:13 packer-builder-qemu plugin: Sending char '3', code 0x33, shift false
2022/01/18 14:08:13 packer-builder-qemu plugin: Sending char '/', code 0x2F, shift false
2022/01/18 14:08:13 packer-builder-qemu plugin: Sending char 'r', code 0x72, shift false
2022/01/18 14:08:13 packer-builder-qemu plugin: Sending char 'o', code 0x6F, shift false
2022/01/18 14:08:13 packer-builder-qemu plugin: Sending char 'c', code 0x63, shift false
2022/01/18 14:08:14 packer-builder-qemu plugin: Sending char 'k', code 0x6B, shift false
2022/01/18 14:08:14 packer-builder-qemu plugin: Sending char 'y', code 0x79, shift false
2022/01/18 14:08:14 packer-builder-qemu plugin: Sending char '-', code 0x2D, shift false
2022/01/18 14:08:14 packer-builder-qemu plugin: Sending char '8', code 0x38, shift false
2022/01/18 14:08:14 packer-builder-qemu plugin: Sending char '.', code 0x2E, shift false
2022/01/18 14:08:15 packer-builder-qemu plugin: Sending char 'c', code 0x63, shift false
2022/01/18 14:08:15 packer-builder-qemu plugin: Sending char 'f', code 0x66, shift false
2022/01/18 14:08:15 packer-builder-qemu plugin: Sending char 'g', code 0x67, shift false
2022/01/18 14:08:15 packer-builder-qemu plugin: Special code '<enter>' found, replacing with: 0xFF0D
2022/01/18 14:08:16 packer-builder-qemu plugin: [INFO] Waiting 1s
2022/01/18 14:08:17 ui: [0;32m    qemu.example: Not using a NetBridge -- skipping StepWaitGuestAddress[0m
2022/01/18 14:08:17 ui: [1;32m==> qemu.example: Using SSH communicator to connect: 127.0.0.1[0m
2022/01/18 14:08:17 packer-builder-qemu plugin: [INFO] Waiting for SSH, up to timeout: 20m0s
2022/01/18 14:08:17 ui: [1;32m==> qemu.example: Waiting for SSH to become available...[0m
2022/01/18 14:08:17 packer-builder-qemu plugin: [INFO] Attempting SSH connection to 127.0.0.1:3860...
2022/01/18 14:08:17 packer-builder-qemu plugin: [DEBUG] reconnecting to TCP connection for SSH
2022/01/18 14:08:17 packer-builder-qemu plugin: [DEBUG] handshaking with SSH
2022/01/18 14:09:17 packer-builder-qemu plugin: [DEBUG] SSH handshake err: Timeout during SSH handshake
2022/01/18 14:09:24 packer-builder-qemu plugin: [INFO] Attempting SSH connection to 127.0.0.1:3860...
2022/01/18 14:09:24 packer-builder-qemu plugin: [DEBUG] reconnecting to TCP connection for SSH
2022/01/18 14:09:24 packer-builder-qemu plugin: [DEBUG] handshaking with SSH
2022/01/18 14:10:24 packer-builder-qemu plugin: [DEBUG] SSH handshake err: Timeout during SSH handshake
2022/01/18 14:10:31 packer-builder-qemu plugin: [INFO] Attempting SSH connection to 127.0.0.1:3860...
2022/01/18 14:10:31 packer-builder-qemu plugin: [DEBUG] reconnecting to TCP connection for SSH
2022/01/18 14:10:31 packer-builder-qemu plugin: [DEBUG] handshaking with SSH
2022/01/18 14:11:31 packer-builder-qemu plugin: [DEBUG] SSH handshake err: Timeout during SSH handshake
2022/01/18 14:11:38 packer-builder-qemu plugin: [INFO] Attempting SSH connection to 127.0.0.1:3860...
2022/01/18 14:11:38 packer-builder-qemu plugin: [DEBUG] reconnecting to TCP connection for SSH
2022/01/18 14:11:38 packer-builder-qemu plugin: [DEBUG] handshaking with SSH
2022/01/18 14:12:26 ui error: Cancelling build after receiving interrupt
2022/01/18 14:12:26 Cancelling builder after context cancellation context canceled
2022/01/18 14:12:26 packer-builder-qemu plugin: Qemu stderr: qemu-kvm: terminating on signal 2
2022/01/18 14:12:26 packer-builder-qemu plugin: Received interrupt signal (count: 1). Ignoring.
2022/01/18 14:12:26 packer-provisioner-ansible plugin: Received interrupt signal (count: 1). Ignoring.
2022/01/18 14:12:26 packer-builder-qemu plugin: [WARN] Interrupt detected, quitting waiting for SSH.
2022/01/18 14:12:26 packer-builder-qemu plugin: failed to unlock port lockfile: close tcp 127.0.0.1:5960: use of closed network connection
2022/01/18 14:12:26 packer-builder-qemu plugin: failed to unlock port lockfile: close tcp 127.0.0.1:3860: use of closed network connection
2022/01/18 14:12:26 ui: [1;32m==> qemu.example: Deleting output directory...[0m
2022/01/18 14:12:26 [INFO] (telemetry) ending qemu.example
2022/01/18 14:12:26 ui error: [1;31mBuild 'qemu.example' errored after 4 minutes 45 seconds: Build was cancelled.[0m
2022/01/18 14:12:26 ui: 
==> Wait completed after 4 minutes 45 seconds
2022/01/18 14:12:26 ui: Cleanly cancelled builds after being interrupted.
2022/01/18 14:12:26 [INFO] (telemetry) Finalizing.
2022/01/18 14:12:26 packer-builder-qemu plugin: [DEBUG] SSH handshake err: ssh: handshake failed: read tcp 127.0.0.1:41592->127.0.0.1:3860: read: connection reset by peer
2022/01/18 14:12:27 waiting for all plugin processes to complete...
2022/01/18 14:12:27 /usr/bin/packer: plugin process exited
2022/01/18 14:12:27 /usr/bin/packer: plugin process exited
